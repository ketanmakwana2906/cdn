const puppeteer = require('puppeteer');

async function testProxy() {
    const proxy = {
        protocol: "http",       // Change to "socks5" if needed
        host: "123.456.789.000", // Replace with a real proxy IP
        port: "8080",           // Proxy port
        auth: { username: "testuser", password: "testpass" } // Proxy authentication
    };

    const browser = await puppeteer.launch({
        headless: true,
        args: [`--proxy-server=${proxy.protocol}://${proxy.host}:${proxy.port}`]
    });

    const page = await browser.newPage();

    // Authenticate Proxy
    await page.authenticate({
        username: proxy.auth.username,
        password: proxy.auth.password
    });

    // Open IP checker site to verify IP change
    await page.goto("https://api64.ipify.org?format=json", { waitUntil: "domcontentloaded" });

    const ip = await page.evaluate(() => document.body.innerText);
    console.log("Current IP:", ip);

    await browser.close();
}

testProxy().catch(console.error);
