select 
        t.code, t.route, t.name, t.short_name, t.type, t.class, t.doo, t.description, ts1.day, 
        c.name as origin,tso.code as origin_code, tso.name as origin_station, c.name as dest,
        tsd.code as dest_code, tsd.name as dest_station, ts1.depart_time, ts1.delay as origin_delay,
        ts2.arrive_time, ts2.delay as dest_delay, 
        CAST(time_format(TIMEDIFF(concat(date(DATE_ADD(NOW(), INTERVAL ts2.day DAY)), " ", ts2.arrive_time), concat(date(DATE_ADD(NOW(), INTERVAL ts1.day DAY)), " ", ts1.depart_time)), '%H:%i')as CHAR) as duration,
        CAST(TIMEDIFF(ts1.depart_time, ts1.arrive_time) as CHAR) as origin_halt,
        (ts2.distance-ts1.distance) as distance, 
        tso.city_id,tsd.city_id,t.origin_id,t.dest_id, t.distance as total_distance, t.pantry_car 
        from train_schedule ts1,
        train_schedule ts2,
        train t,
        train_station tso,
        train_station tsd,
        city c 
        where 
            t.class != 'NULL'
            and t.class != 'NULL'
            tso.id = ts1.train_station_id and 
            tsd.id = ts2.train_station_id and 
            ts1.stops=1 and 
            ts2.stops=1 and 
            ts1.train_id=ts2.train_id 
            and ts1.distance < ts2.distance 
            and ts1.day <= ts2.day 
            and ts1.route = ts2.route 
            and t.id=ts1.train_id 
            and tso.city_id=c.id 
            and tsd.city_id=c.id 
            and tso.code=8376
            and tsd.code=8376
            and t.is_active = 1
        order by t.route;

    19:43:57	select          t.code, t.route, t.name, t.short_name, t.type, t.class, t.doo, t.description, ts1.day,          c.name as origin,tso.code as origin_code, tso.name as origin_station, c.name as dest,         tsd.code as dest_code, tsd.name as dest_station, ts1.depart_time, ts1.delay as origin_delay,         ts2.arrive_time, ts2.delay as dest_delay,          CAST(time_format(TIMEDIFF(concat(date(DATE_ADD(NOW(), INTERVAL ts2.day DAY)), " ", ts2.arrive_time), concat(date(DATE_ADD(NOW(), INTERVAL ts1.day DAY)), " ", ts1.depart_time)), '%H:%i')as CHAR) as duration,         CAST(TIMEDIFF(ts1.depart_time, ts1.arrive_time) as CHAR) as origin_halt,         (ts2.distance-ts1.distance) as distance,          tso.city_id,tsd.city_id,t.origin_id,t.dest_id, t.distance as total_distance, t.pantry_car          from train_schedule ts1,         train_schedule ts2,         train t,         train_station tso,         train_station tsd,         city c          where              t.class != 'NULL'             and t.class != 'NULL'             tso.id = ts1.train_station_id and              tsd.id = ts2.train_station_id and              ts1.stops=1 and              ts2.stops=1 and              ts1.train_id=ts2.train_id              and ts1.distance < ts2.distance              and ts1.day <= ts2.day              and ts1.route = ts2.route              and t.id=ts1.train_id              and tso.city_id=c.id              and tsd.city_id=c.id              and tso.code=8376             and tsd.code=8376             and t.is_active = 1         order by t.route	Error Code: 1064. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'tso.id = ts1.train_station_id and              tsd.id = ts2.train_station_id and' at line 19	0.0020 sec
