from oauth2_provider.oauth2_validators import OAuth2Validator

class CustomOAuth2Validator(OAuth2Validator):
    def validate_user(self, username, password, client, request, *args, **kwargs):
        errors = []  # Store authentication errors

        user = custom_authenticate(username=username, password=password, errors=errors)

        if user:
            request.user = user
            return True

        # Store errors in request to be used later
        request.oauth2_errors = errors  
        return False
