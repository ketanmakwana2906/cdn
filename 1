import pandas as pd
from sqlalchemy import create_engine

# Database connection details
DB_USER = "your_username"
DB_PASSWORD = "your_password"
DB_HOST = "localhost"  # Change if needed
DB_NAME = "your_database"
TABLE_NAME = "your_table"

# Create DB connection
engine = create_engine(f"mysql+pymysql://{DB_USER}:{DB_PASSWORD}@{DB_HOST}/{DB_NAME}")

# Load CSV file
csv_file_path = "metabase_data.csv"  # Change this to your file path
df = pd.read_csv(csv_file_path)

# Insert data into the database (Replace if necessary)
df.to_sql(TABLE_NAME, con=engine, if_exists="replace", index=False)

print("Data synced successfully!")
