i think below is perfect and proper method , pleae review and let me know if any potential issue you can see

class CustomOAuth2Validator(OAuth2Validator):
    def validate_user(self, username, password, client, request, *args, **kwargs):
        kwargs["custom_validator_used"] = True
        u = authenticate(username=username, password=password, **kwargs)
        if u is not None and u.is_active:
            request.user = u
            return True
        return False
    
class CustomTokenView(TokenView):
    validator_class = CustomOAuth2Validator
    def post(self, request, *args, **kwargs):
        try:
            response = super().post(request, *args, **kwargs)
            return response
        except AuthenticationFailed as e:
            message = e.detail[0]
            return Response({"success":False, "message": message}, status=status.HTTP_200_OK)

class customBackend(ModelBackend):
    def authenticate(self, username=None, password=None, errors=[], **kwargs):
        UserModel = get_user_model()
        # from User.tasks import wa_opted_func

        if username is None:
            username = kwargs.get(UserModel.USERNAME_FIELD)
            print("username", username)
        if username is None:
            return

        try:
            # Allow phone + otp login
            # Check if username is a phone number
            wa_opted_user = None
            if username.isdigit() and len(username) == 10:
                user = UserModel.objects.get(phone=username)
                # if 'wa_opt' in kwargs.keys():
                #     print("wa_opt is true")
                #     params = {}
                #     params['username'] = kwargs.get('username')
                #     params['wa_opt'] = kwargs.get('wa_opt')
                #     success = run_via_celery(wa_opted_func, **params)
                #     del params
                used, expired, verified, new_phone, invalidate_all = UserOtp.verify(
                    user, password)
                if not any((used, expired, verified, new_phone, invalidate_all)):
                    errors.append("Seems like you entered wrong OTP")
                else:
                    if invalidate_all:
                        errors.append("OTP expired! Please retry.")
                    if used:
                        errors.append("OTP has already been used.")
                    if expired:
                        errors.append("OTP expired! Please retry.")
                    if verified:
                        return user
                custom_validator_used = kwargs.get("custom_validator_used")
                if errors and custom_validator_used:
                    raise AuthenticationFailed(errors)
            else:
                # Email + password login

                user = UserModel._default_manager.get_by_natural_key(username)
                if user.check_password(password) and user.is_email_verified:
                    return user

                # Since password gets created later, this is not required
                # if not user.is_email_verified:
                #     errors.append("Email not verified")

        except UserModel.DoesNotExist:
            # Run the default password hasher once to reduce the timing
            # difference between an existing and a non-existing user (#20760).
            UserModel().set_password(password)


url(r'^services/auth/token/v2', CustomTokenView.as_view()),
